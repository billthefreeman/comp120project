
if (changeMode == 1) {
    <% if (@added>0) %> {
      wait = Math.max(minWait, wait / 2);
      if (direction == 1) {
        direction = -1;
        changeMode = 2;
      }
    }
    <% else %> {
      wait = Math.min(maxWait, wait * 2); 
      if (direction == -1) {
        direction = 1;
        changeMode = 2;
      }  
    }
    <% end %>
}
else {
	<% if (@added>0) %> {
	  wait = Math.max(minWait, wait - 5000);
	  if (direction == -1) {
	    changeMode = 1;
	  }
	  else {
	    direction = -1;
	  }
	}
	<% else %> {
	  wait = Math.max(minWait, wait + 5000);
	  if (direction == 1) {
	    changeMode = 1;
	  }
	  else {
	    direction = 1;
	  }
	}
	<% end %>
}

<% if (@added>0) %>
	if($("#show_incidents").is(":hidden")) {
		//console.log("in index.js.erb")
		$("#show_incidents").show();  

		//<% $redis.hset('new_incidents', 'number', 2) %>
		//console.log("<%= $redis.hget('new_incidents','number').to_i%>");

		var old = $("#reported").text();
		//console.log(old);
		var current = Number(old) + Number("<%= @added %>");
		$("#reported").text(current);
	}
<% end %>



